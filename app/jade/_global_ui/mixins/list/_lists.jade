//- Angular ngRepeat based nestable lists
mixin angularLists(listId)
  - //console.log('asking for list ' + listId);
  - var list = util.setListDefaults(listId);
  - var listClass = list.class || '';
  - var buttonClass = list.buttonClass || '';
  - list.tooltip = list.tooltip || {};
  //- Value has priority on ngBind
  - var ngRepeatValue = (list.value) ? '{{ ' + list.value + ' }}' : '';
  - var ngBind = (list.ngBind && !list.value) ? list.ngBind: null;
  - var buttons = gData.buttons

  ul(class="list-#{listId} list list-unstyled #{listClass}")

    if list.buttonsInstances
      //- Special type of list : the toolbars (a list of icons)
      each btnId in list.buttonsInstances
        - var btnObj = buttons[btnId];
        li( class='cpointer btn btn-fit-height #{buttonClass}',
            ui-sref=btnObj.uiSref,
            ng-click=btnObj.ngClick,
            ng-show=btnObj.ngShow)
          i(class=btnObj.icon)
          if (btnObj.label)
            span(title=btnObj.title)=btnObj.label
    else
      //- common list display
      +defaultTextngRepeat(list, list.ngRepeat)
      // @todo not useful ? if
      li(ng-if='(#{list.ngRepeat}).length > 0', ng-repeat='item in #{list.ngRepeat}' )
        if(list.link)
          a(ui-sref=list.link,
            tooltip-placement=list.tooltip.position, tooltip=list.tooltip.value,
            ng-bind=ngBind)=ngRepeatValue
        else
          span(
            tooltip-placement=list.tooltip.position, tooltip=list.tooltip.value,
            ng-bind=ngBind)=ngRepeatValue
        if (list.listInstance && list.listInstance.id)
          +angularLists(list.listInstance.id)