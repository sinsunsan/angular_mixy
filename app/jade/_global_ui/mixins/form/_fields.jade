mixin fieldLabelCommon(field)
  - var label = (field.type === 'submit') ? '' : field.label;
  - label = (!_.isString(label)) ? '' : label;
  label(for=field.id, class="field-label #{field.width.label}")&attributes(attributes)
    span=label
    block

//- a field object
//- tooltipType: 'twbs' or 'md'
mixin fieldLabel(field, tooltipType)
  - console.log('\n\nfield label ', field, tooltipType);
  if (tooltipType === 'twbs')
    - field.tooltipOptionDefault = { placement: 'right', popupDelay: 500 };
    - field.tooltipOptions = field.tooltipOptions || field.tooltipOptionDefault;
    +fieldLabelCommon(field)(
      uib-tooltip=field.tooltip,
      tooltip-popup-delay=field.tooltipOptions.popupDelay,
      tooltip-placement=field.tooltipOptions.placement)
      i(class="m-l-xs fa fa-question-circle")

  else if (tooltipType === 'md')
    +fieldLabelCommon(field)
    +mdTooltip

  else
    +fieldLabelCommon(field)

mixin fieldGroup(field)
  - field = field || {};
  - field.css = field.css || {};
  - field.class = field.class || '';
  - field.style = field.style || null;
  - field.width = field.width || {};
  - var optClasses =+ (field.multiple) ? ' multiple ' : '';
  - var wrapperCustomAttributes = field.wrapperCustomAttributes || {};

  div(
      class="form-group m-b-lg #{field.css.group} #{field.class}",
      style=field.style,
      ng-class!="{ 'has-error' : #{field.id}.$invalid && !#{field.id}.$pristine }",
      ng-show!=field.ngShow,
      ng-hide=field.ngHide
      )&attributes(wrapperCustomAttributes)

    //- field label
    if (field.label)
      if field.tooltip
        if (field.tooltipType === 'md')
          //- with angular material version
          +fieldLabel(field, 'md')

        else
          //- with twitter boostrap version
          +fieldLabel(field, 'twbs')

      else
        //- without tooltip
        +fieldLabel(field)

    //- field main html tag
    div(class="field-tag #{field.width.tag}")
      block

    //- field suffix (unites, prices currency....)
    if (field.suffix)
      div(class="field-suffix #{field.width.suffix} text-left")=field.suffix

    - console.log(field.errors && field.errorsInstances);
    //- we display the field-errors zone always so that the layout don't move when the errors are displayed
    div(class="field-errors")
      //- field errors : display validation errors for this field
      if (field.errors && field.errorsInstances || field.required ||Â field.ngMinlength || field.ngMaxlength)
        +errorNgMessages(field)