mixin fieldsWrapper(formId, stateId, fieldId, field)
  -  field.class = field.class ||Â '';
  div(class='clearfix #{field.class}', ng-show!=field.ngShow)
    - //- label is inherited from global field label (used in another context)
    - //- whereas in the new context label are set as a string
    - //- so we use this quick and dirty way to prevent object label from applying
    - //- @todo uniformise label handling between fields and toolbars
    - field.label = (!_.isObject(field.label)) ? field.label : null;

    if field.label
      div(class="field-group-label fs1")=field.label

    if field.fieldsInstances
      each fieldId in field.fieldsInstances
        //- fieldsWrapper is called by fieldById
        //- and call it's caller to insert wrapped fields
        +fieldById(formId, stateId, fieldId)